Lab 02 - Plastic waste
================
Qilin Zhang
1/13/2023

## Load packages and data

``` r
library(tidyverse) 
```

``` r
plastic_waste <- read.csv("data/plastic-waste.csv")
```

## Exercises

ggplot(data = plastic_waste, aes(x = plastic_waste_per_cap)) +
geom_histogram(binwidth = 0.2)

plastic_waste %\>% filter(plastic_waste_per_cap \> 3.5)

The result does not come surprise after looking it up online. Trinidad
and Tobago seems to have a huge problem in plastic waste in recent
years. \### Exercise 1

``` r
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_histogram()
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

    ## Warning: Removed 51 rows containing non-finite values (`stat_bin()`).

![](lab-02_files/figure-gfm/plastic-waste-continent-1.png)<!-- -->

``` r
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_density(alpha = 0.7)
```

    ## Warning: Removed 51 rows containing non-finite values (`stat_density()`).

![](lab-02_files/figure-gfm/plastic-waste-continent-2.png)<!-- --> Data
from each continent is similar with an exception of North America. It
has a significant positive outlier (Trinidad and Tobago).

### Exercise 2

``` r
#2.1
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_density(alpha = 0.1)
```

    ## Warning: Removed 51 rows containing non-finite values (`stat_density()`).

![](lab-02_files/figure-gfm/plastic-waste-density-1.png)<!-- -->

### Exercise 3

The reason why we put “color” and “fill” in mapping instead of
“geom_point” is that we hope to separate the data by the variable
“continent” in later graphs. If we add “color” to the “geom——xxx”, it
will tell R to fit color to the plot generated by all the data (without
being categorized by “continent”). This would not accomplish the goal of
comparing across continents and will likely be unachievable because of
the nature of density plot.

``` r
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, y = continent))+
geom_boxplot()
```

    ## Warning: Removed 51 rows containing non-finite values (`stat_boxplot()`).

![](lab-02_files/figure-gfm/unnamed-chunk-1-1.png)<!-- -->

### Exercise 4

Violin plot reveals the frequency of plastic waste per cap. We can
better see the concentration of the same plastic waste per cap better
compared to box plot.

``` r
ggplot(data = plastic_waste,mapping = aes(x = continent , y = plastic_waste_per_cap))+
geom_violin()
```

    ## Warning: Removed 51 rows containing non-finite values (`stat_ydensity()`).

![](lab-02_files/figure-gfm/plastic-waste-violin-1.png)<!-- -->

### Exercise 5

It seems like there is a weak linear relationship when we included the
outlier. In particular, r is around 0.04 (p =0.02). However, after
trimming the outlier, the linear relationship no longer hold (p = 0.26)

``` r
# raw data
ggplot(data = plastic_waste, aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap))+
geom_point()
```

    ## Warning: Removed 51 rows containing missing values (`geom_point()`).

![](lab-02_files/figure-gfm/plastic-waste-mismanaged-1.png)<!-- -->

``` r
regression <- lm(mismanaged_plastic_waste_per_cap~plastic_waste_per_cap, data =plastic_waste)
summary(regression)
```

    ## 
    ## Call:
    ## lm(formula = mismanaged_plastic_waste_per_cap ~ plastic_waste_per_cap, 
    ##     data = plastic_waste)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -0.05092 -0.04027 -0.00962  0.02193  0.24746 
    ## 
    ## Coefficients:
    ##                       Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)           0.037017   0.004332   8.544 4.49e-15 ***
    ## plastic_waste_per_cap 0.040677   0.012771   3.185   0.0017 ** 
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.04855 on 187 degrees of freedom
    ##   (因为不存在，51个观察量被删除了)
    ## Multiple R-squared:  0.05146,    Adjusted R-squared:  0.04639 
    ## F-statistic: 10.14 on 1 and 187 DF,  p-value: 0.001696

``` r
rm(regression)


data <- plastic_waste %>%
  filter(plastic_waste_per_cap <3.5)

ggplot(data = data, aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap))+
geom_point()
```

![](lab-02_files/figure-gfm/plastic-waste-mismanaged-2.png)<!-- -->

``` r
regression <- lm(mismanaged_plastic_waste_per_cap~plastic_waste_per_cap, data =data)
summary(regression)
```

    ## 
    ## Call:
    ## lm(formula = mismanaged_plastic_waste_per_cap ~ plastic_waste_per_cap, 
    ##     data = data)
    ## 
    ## Residuals:
    ##       Min        1Q    Median        3Q       Max 
    ## -0.046833 -0.040115 -0.009316  0.021586  0.248923 
    ## 
    ## Coefficients:
    ##                       Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)           0.038406   0.006283   6.112 5.64e-09 ***
    ## plastic_waste_per_cap 0.032692   0.029061   1.125    0.262    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.04866 on 186 degrees of freedom
    ## Multiple R-squared:  0.006758,   Adjusted R-squared:  0.001418 
    ## F-statistic: 1.266 on 1 and 186 DF,  p-value: 0.2621

``` r
rm(regression)
rm(data)
```

### Exercise 6

There are no clear sign of differentiation between continents except for
one outlier for North America.

``` r
ggplot(data = plastic_waste,mapping = aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap, color= continent))+
geom_point()
```

    ## Warning: Removed 51 rows containing missing values (`geom_point()`).

![](lab-02_files/figure-gfm/plastic-waste-mismanaged-continent-1.png)<!-- -->

### Exercise 7

Two pairs of variables show similar relationship with each others. Their
r values are all around -0.07.

``` r
ggplot(data = plastic_waste,mapping = aes(x = total_pop , y = plastic_waste_per_cap, color= continent))+
geom_point()
```

    ## Warning: Removed 61 rows containing missing values (`geom_point()`).

![](lab-02_files/figure-gfm/plastic-waste-population-total-1.png)<!-- -->

``` r
cor(plastic_waste$plastic_waste_per_cap, plastic_waste$total_pop, use = "pairwise.complete.obs")
```

    ## [1] -0.07318113

``` r
ggplot(data = plastic_waste,mapping = aes(x = coastal_pop , y = plastic_waste_per_cap, color= continent))+
geom_point()
```

    ## Warning: Removed 51 rows containing missing values (`geom_point()`).

![](lab-02_files/figure-gfm/plastic-waste-population-coastal-1.png)<!-- -->

``` r
cor(plastic_waste$plastic_waste_per_cap, plastic_waste$coastal_pop, use = "pairwise.complete.obs")
```

    ## [1] -0.07699641

### Exercise 8

``` r
data <- plastic_waste %>%
  filter(plastic_waste_per_cap < 3)
data$y <- data$coastal_pop/data$total_pop

ggplot(data = data, aes(x = y, y = plastic_waste_per_cap))+
  geom_point(mapping = aes(color=continent))+
  geom_smooth()+
  labs(title= "plastic_waste v.s coastal population proportion",
       subtitle = "by continent",
       x = "plastic waste per capita",
       y = "coastal population proportion (coastal/total population)")+
  scale_color_viridis_d()
```

    ## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'

    ## Warning: Removed 10 rows containing non-finite values (`stat_smooth()`).

    ## Warning: Removed 10 rows containing missing values (`geom_point()`).

![](lab-02_files/figure-gfm/recreate-viz-1.png)<!-- -->

``` r
rm(data)
```

## Pro-Tips

### Excercise 3

Try this :D

ggplot(data = plastic_waste, mapping = aes(x = continent, y =
plastic_waste_per_cap)) + geom_violin()+ geom_boxplot(width=.3,
fill=“green”) + stat_summary(fun.y=median, geom=“point”)

### Exercise 5

Helpful
reference:<http://www.sthda.com/english/wiki/ggplot2-themes-and-background-colors-the-3-elements>
