---
title: "Lab 02 - Plastic waste"
author: "Qilin Zhang"
date: "1/13/2023"
output: html_document
---

## Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
```

```{r load-data, message=FALSE}
plastic_waste <- read.csv("data/plastic-waste.csv")
```

## Exercises
ggplot(data = plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_histogram(binwidth = 0.2)
  
plastic_waste %>%
  filter(plastic_waste_per_cap > 3.5)
  
The result does not come surprise after looking it up online. Trinidad and Tobago seems to have a huge problem in plastic waste in recent years.
### Exercise 1

```{r plastic-waste-continent}
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_histogram()

ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_density(alpha = 0.7)
```
Data from each continent is similar with an exception of North America. It has a significant positive outlier (Trinidad and Tobago).


### Exercise 2

```{r plastic-waste-density}
#2.1
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, color = continent, fill = continent))+
geom_density(alpha = 0.1)
```

### Exercise 3
The reason why we put "color" and "fill" in mapping instead of "geom_point" is that we hope to separate the data by the variable "continent" in later graphs. If we add "color" to the "geom——xxx", it will tell R to fit color to the plot generated by all the data (without being categorized by "continent"). This would not accomplish the goal of comparing across continents and will likely be unachievable because of the nature of density plot. 

```{r}
ggplot(data = plastic_waste,mapping = aes(x = plastic_waste_per_cap, y = continent))+
geom_boxplot()
```

### Exercise 4

Violin plot reveals the frequency of plastic waste per cap. We can better see the concentration of the same plastic waste per cap better compared to box plot.

```{r plastic-waste-violin}
ggplot(data = plastic_waste,mapping = aes(x = continent , y = plastic_waste_per_cap))+
geom_violin()
```

### Exercise 5
It seems like there is a weak linear relationship when we included the outlier. In particular, r is around 0.04 (p =0.02).
However, after trimming the outlier, the linear relationship no longer hold (p = 0.26)

```{r plastic-waste-mismanaged}
# raw data
ggplot(data = plastic_waste, aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap))+
geom_point()

regression <- lm(mismanaged_plastic_waste_per_cap~plastic_waste_per_cap, data =plastic_waste)
summary(regression)
rm(regression)


data <- plastic_waste %>%
  filter(plastic_waste_per_cap <3.5)

ggplot(data = data, aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap))+
geom_point()

regression <- lm(mismanaged_plastic_waste_per_cap~plastic_waste_per_cap, data =data)
summary(regression)
rm(regression)
rm(data)


```

### Exercise 6
There are no clear sign of differentiation between continents except for one outlier for North America. 

```{r plastic-waste-mismanaged-continent}
ggplot(data = plastic_waste,mapping = aes(x = mismanaged_plastic_waste_per_cap , y = plastic_waste_per_cap, color= continent))+
geom_point()
```

### Exercise 7

Two pairs of variables show similar relationship with each others. Their r values are all around -0.07.

```{r plastic-waste-population-total}
ggplot(data = plastic_waste,mapping = aes(x = total_pop , y = plastic_waste_per_cap, color= continent))+
geom_point()

cor(plastic_waste$plastic_waste_per_cap, plastic_waste$total_pop, use = "pairwise.complete.obs")
```

```{r plastic-waste-population-coastal}
ggplot(data = plastic_waste,mapping = aes(x = coastal_pop , y = plastic_waste_per_cap, color= continent))+
geom_point()

cor(plastic_waste$plastic_waste_per_cap, plastic_waste$coastal_pop, use = "pairwise.complete.obs")
```

### Exercise 8

```{r recreate-viz}
data <- plastic_waste %>%
  filter(plastic_waste_per_cap < 3)
data$y <- data$coastal_pop/data$total_pop

ggplot(data = data, aes(x = y, y = plastic_waste_per_cap))+
  geom_point(mapping = aes(color=continent))+
  geom_smooth()+
  labs(title= "plastic_waste v.s coastal population proportion",
       subtitle = "by continent",
       x = "plastic waste per capita",
       y = "coastal population proportion (coastal/total population)")+
  scale_color_viridis_d()
  
rm(data)
```

## Pro-Tips

### Excercise 3

Try this :D

ggplot(data = plastic_waste, 
       mapping = aes(x = continent, 
                     y = plastic_waste_per_cap)) +
  geom_violin()+
  geom_boxplot(width=.3, fill="green") +
  stat_summary(fun.y=median, geom="point") 
  
### Exercise 5 

Helpful reference:http://www.sthda.com/english/wiki/ggplot2-themes-and-background-colors-the-3-elements



